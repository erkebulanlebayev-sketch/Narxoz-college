# Настройка обменника материалами

## Обзор
Обменник позволяет студентам загружать и скачивать учебные материалы (конспекты, домашки, проекты, экзамены).

## Возможности
- ✅ Загрузка файлов (PDF, DOC, DOCX, PPT, PPTX, TXT, ZIP до 50MB)
- ✅ Категоризация материалов
- ✅ Система тегов
- ✅ Счетчик скачиваний
- ✅ Рейтинговая система
- ✅ Фильтрация по категориям
- ✅ Управление своими материалами

## Настройка Supabase

### 1. Создание таблицы materials

Выполните SQL из файла `supabase-setup.sql` - таблица `materials` уже включена.

### 2. Настройка Storage

#### Вариант A: Через Supabase Dashboard (рекомендуется)

1. Откройте Supabase Dashboard
2. Перейдите в раздел **Storage**
3. Нажмите **New bucket**
4. Создайте bucket с параметрами:
   - Name: `materials`
   - Public: ✅ (включено)
   - File size limit: 52428800 (50MB)
   - Allowed MIME types: оставьте пустым или укажите:
     - `application/pdf`
     - `application/msword`
     - `application/vnd.openxmlformats-officedocument.wordprocessingml.document`
     - `application/vnd.ms-powerpoint`
     - `application/vnd.openxmlformats-officedocument.presentationml.presentation`
     - `text/plain`
     - `application/zip`

5. Перейдите в **Policies** для bucket `materials`
6. Выполните SQL из файла `supabase-storage-setup.sql`

#### Вариант B: Через SQL

Выполните весь SQL из файла `supabase-storage-setup.sql` в SQL Editor.

### 3. Проверка настроек

Убедитесь, что:
- ✅ Таблица `materials` создана
- ✅ Bucket `materials` создан и публичный
- ✅ Политики доступа настроены
- ✅ RLS включен для таблицы `materials`

## Использование

### Загрузка материала

1. Перейдите на страницу **Обменник**
2. Переключитесь на вкладку **Мои загрузки**
3. Нажмите **Загрузить материал**
4. Заполните форму:
   - Название материала
   - Описание
   - Категория (конспекты/домашки/проекты/экзамены)
   - Предмет
   - Теги (через запятую)
   - Файл (до 50MB)
5. Нажмите **Загрузить**

### Скачивание материала

1. Перейдите на вкладку **Все материалы**
2. Выберите категорию (опционально)
3. Найдите нужный материал
4. Нажмите **Скачать**

### Удаление материала

1. Перейдите на вкладку **Мои загрузки**
2. Найдите материал
3. Нажмите **Удалить**
4. Подтвердите удаление

## Структура файлов

Файлы хранятся в Supabase Storage по пути:
```
materials/{user_id}/{timestamp}-{random}.{extension}
```

Пример:
```
materials/123e4567-e89b-12d3-a456-426614174000/1709280000000-abc123.pdf
```

## Безопасность

- Только аутентифицированные пользователи могут загружать файлы
- Пользователи могут удалять только свои файлы
- Максимальный размер файла: 50MB
- Поддерживаемые форматы: PDF, DOC, DOCX, PPT, PPTX, TXT, ZIP

## Будущие улучшения

- [ ] Система рейтингов (возможность оценивать материалы)
- [ ] Комментарии к материалам
- [ ] Поиск по названию и тегам
- [ ] Предварительный просмотр файлов
- [ ] Модерация материалов
- [ ] Статистика загрузок
- [ ] Уведомления о новых материалах
